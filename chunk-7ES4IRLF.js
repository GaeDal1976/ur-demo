import{a as b,b as M,c as k,d as I,e as f,g as V,h as z,i as G,k as q,l as L,n as U,o as j,r as c}from"./chunk-KXXKTX2T.js";import{p as w,q as R,r as T,s as A,u as g,v as C,w as y}from"./chunk-54NO2V2Q.js";import{e as N,i as P}from"./chunk-KODN66SN.js";import{Aa as o,Fb as a,Hb as F,Ib as O,Ka as h,Qa as x,Xa as i,_a as d,db as r,eb as n,fb as s,ia as S,nb as D,ob as _,xb as m,zb as E}from"./chunk-P6AE7GFT.js";var v=()=>({color:"var(--primary-darker)","font-weight":600}),B=()=>({name:"No",value:!1}),H=()=>({name:"SI",value:!0}),J=(e,l)=>[e,l],K=()=>({name:"-",value:null}),Q=()=>({name:"Fattura",value:"Fattura"}),W=()=>({name:"A Consuntivo",value:"A Consuntivo"}),X=(e,l,t)=>[e,l,t];function Y(e,l){if(e&1&&(r(0,"div",9)(1,"label",10),m(2," Validit\xE0 da *"),n(),s(3,"p-datepicker",11),n()),e&2){let t=_(2);o(),d(a(3,v)),o(2),i("minDate",t.today)}}function $(e,l){if(e&1&&(r(0,"div",9)(1,"label",12),m(2," Validit\xE0 a *"),n(),s(3,"p-datepicker",13),n()),e&2){let t=_(2);o(),d(a(3,v)),o(2),i("minDate",t.today)}}function ee(e,l){e&1&&(r(0,"div",9)(1,"label",14),m(2," Sconto %"),n(),s(3,"p-inputnumber",15),n()),e&2&&(o(),d(a(3,v)),o(2),i("useGrouping",!1))}function te(e,l){e&1&&(r(0,"div",9)(1,"label",16),m(2," Sconto \u20AC"),n(),s(3,"p-inputnumber",17),n()),e&2&&(o(),d(a(3,v)),o(2),i("useGrouping",!1))}function oe(e,l){if(e&1&&(r(0,"div",9)(1,"label",18),m(2," Tipo Sconto *"),n(),s(3,"p-select",19),n()),e&2){let t=_(2);o(),d(a(3,v)),o(2),i("options",t.typeOptions)}}function ne(e,l){e&1&&(r(0,"div",9)(1,"label",20),m(2," Cumula Sconto"),n(),s(3,"p-select",21),n()),e&2&&(o(),d(a(3,v)),o(2),i("options",F(6,J,a(4,B),a(5,H))))}function ie(e,l){e&1&&(r(0,"div",9)(1,"label",22),m(2," Configurazione"),n(),s(3,"p-select",23),n()),e&2&&(o(),d(a(3,v)),o(2),i("options",O(7,X,a(4,K),a(5,Q),a(6,W))))}function re(e,l){if(e&1&&(r(0,"form",6)(1,"div",7),x(2,Y,4,4,"div",8)(3,$,4,4,"div",8),n(),r(4,"div",7),x(5,ee,4,4,"div",8)(6,te,4,4,"div",8),n(),r(7,"div",7),x(8,oe,4,4,"div",8)(9,ne,4,9,"div",8)(10,ie,4,11,"div",8),n()()),e&2){let t=_();i("formGroup",t.form),o(2),i("ngIf",t.form.get("validitaDa")),o(),i("ngIf",t.form.get("validitaA")),o(2),i("ngIf",t.form.get("scontoPercentuale")),o(),i("ngIf",t.form.get("scontoImporto")),o(2),i("ngIf",t.form.get("tipoSconto")),o(),i("ngIf",t.form.get("cumulaSconto")),o(),i("ngIf",t.form.get("configurazione"))}}function ae(e,l){if(e&1&&(r(0,"p",24),m(1),n()),e&2){let t=_();o(),E(" ",t.form.getError("oneDiscountRequired"),`
`)}}var be=(()=>{class e{submit=new S;cancel=new S;added;type=c.Costruttore;formSubmitted;form;typeOptions;today=new Date;ngOnInit(){let t=new Date,u=new Date(t.setDate(t.getDate()+1));this.form=new I({[w]:new f(new Date,[b.required]),[R]:new f(u,[b.required]),[T]:new f(0,[]),[A]:new f(0,[]),[g]:new f(null,[b.required]),[C]:new f(null,[])},[this.RequiredImportOrPercentage()]),this.type==c.PDS&&(this.form.get(g)?.setValue(c.PDS),this.form.get(g)?.disable(),this.typeOptions=[{name:"PDS",value:c.PDS}]),this.type==c.Costruttore&&(this.form.get(g)?.setValue(c.Costruttore),this.form.addControl(y,new f(null,[])),this.form.get(C)?.disable(),this.form.get(y)?.disable(),this.typeOptions=[{name:"Sconto Costruttore",value:c.Costruttore},{name:"Promo",value:c.Promo}],this.detectTypeChanges())}detectTypeChanges(){this.form.get(g)?.valueChanges.subscribe(t=>{t==c.Promo?(this.form.get(y)?.enable(),this.form.get(C)?.enable()):(this.form.get(y)?.reset(),this.form.get(y)?.disable(),this.form.get(C)?.reset(),this.form.get(C)?.disable())})}onSubmit(){if(this.formSubmitted=!0,this.form.valid){let t=this.form.value;this.form.disable(),this.submit.emit(t)}}RequiredImportOrPercentage(){return t=>{if(!(t instanceof I))return null;let u=t.get(A),p=t.get(T);return u?.value||p?.value?null:{oneDiscountRequired:"\u201CSconto %\u201D e \u201CSconto \u20AC\u201D dove deve essere valorizzato almeno uno dei due (possono essere valorizzati anche entrambi)."}}}static \u0275fac=function(u){return new(u||e)};static \u0275cmp=h({type:e,selectors:[["add-sconto"]],inputs:{added:"added",type:"type"},outputs:{submit:"submit",cancel:"cancel"},decls:8,vars:3,consts:[["class","flex flex-col gap-2",3,"formGroup",4,"ngIf"],["class","error pt-2",4,"ngIf"],[1,"footer","flex","gap-1"],[1,"flex","justify-between","w-full"],["type","button",1,"ur-button","secondary",3,"click"],["type","button",1,"ur-button","accent",3,"click","disabled"],[1,"flex","flex-col","gap-2",3,"formGroup"],[1,"flex","flex-row","gap-2"],["class","flex flex-col flex-auto",4,"ngIf"],[1,"flex","flex-col","flex-auto"],["for","validitaDa"],["formControlName","validitaDa",3,"minDate"],["for","validitaA"],["formControlName","validitaA",3,"minDate"],["for","scontoPercentuale"],["min","0","max","100","formControlName","scontoPercentuale","inputId","scontoPercentuale",3,"useGrouping"],["for","scontoImporto"],["min","0","formControlName","scontoImporto","inputId","scontoImporto",3,"useGrouping"],["for","tipoSconto"],["formControlName","tipoSconto","optionValue","value","optionLabel","name",3,"options"],["for","cumulaSconto"],["formControlName","cumulaSconto","optionValue","value","optionLabel","name",3,"options"],["for","configurazione"],["formControlName","configurazione","optionValue","value","optionLabel","name",3,"options"],[1,"error","pt-2"]],template:function(u,p){u&1&&(x(0,re,11,8,"form",0)(1,ae,2,1,"p",1),r(2,"div",2)(3,"div",3)(4,"button",4),D("click",function(){return p.cancel.emit()}),m(5," Annulla "),n(),r(6,"button",5),D("click",function(){return p.onSubmit()}),m(7," Conferma "),n()()()),u&2&&(i("ngIf",p.form),o(),i("ngIf",p.form.hasError("oneDiscountRequired")&&p.formSubmitted),o(5),i("disabled",p.added))},dependencies:[P,N,q,V,M,k,z,G,L,U,j],styles:[".error[_ngcontent-%COMP%]{font-size:.8rem;color:var(--alert);line-break:auto}.footer[_ngcontent-%COMP%]{padding:2rem 0}"]})}return e})();export{be as a};
